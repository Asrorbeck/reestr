(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[28],{48979:function(e,a,t){Promise.resolve().then(t.bind(t,79718))},79718:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return U}});var s=t(57437),i=t(2265);let l=[];var r=t(97626),n=t(73578),d=t(35974),o=t(62869),c=t(95186),m=t(53647),x=t(66070),u=t(92735),h=t(73247),g=t(42208),j=t(94508);let f={axborotTizimiNomi:"Axborot tizimi yoki resursning to'liq nomi",integratsiyaUsuli:"Integratsiyani amalga oshirish usuli",malumotNomi:"Uzatiladigan/qabul qilinadigan ma'lumot nomi",tashkilotNomiVaShakli:"Integratsiya qilingan tashkilot nomi va shakli",asosiyMaqsad:"Integratsiyadan asosiy maqsad",normativHuquqiyHujjat:"Normativ-huquqiy hujjat",texnologikYoriknomaMavjudligi:"Texnologik yo'riqnoma mavjudligi",malumotFormati:"Ma'lumot formati",maqlumotAlmashishSharti:"Ma'lumot almashish sharti",yangilanishDavriyligi:"Ma'lumot yangilanish davriyligi",malumotHajmi:"Ma'lumot hajmi",aloqaKanali:"Hamkor tashkilot bilan aloqa kanali",oxirgiUzatishVaqti:"So'nggi muvaffaqiyatli uzatish vaqti",markaziyBankAloqa:"Markaziy bank tomonidan texnik aloqa shaxsi",hamkorAloqa:"Hamkor tashkilot tomonidan texnik aloqa shaxsi",status:"Integratsiya holati / statusi",izoh:"Izoh / qo'shimcha ma'lumot"},y={created:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",updated:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",deleted:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300","Integratsiya yaratildi":"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300","Integratsiya tahrirlandi":"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300","Integratsiya arxivlandi":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300","Integratsiya o'chirildi":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300","Integratsiya ko'rildi":"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300","Tizim sozlamalari o'zgartirildi":"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300",default:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300"},v={created:"Integratsiya yaratildi",updated:"Integratsiya tahrirlandi",deleted:"Integratsiya o'chirildi"};function p(e){let{logs:a,onViewDetails:t}=e,[l,r]=(0,i.useState)(""),[p,N]=(0,i.useState)("all"),[b,k]=(0,i.useState)("all"),w=a.filter(e=>{let a=e.action.toLowerCase().includes(l.toLowerCase())||e.userName.toLowerCase().includes(l.toLowerCase())||e.integrationName&&e.integrationName.toLowerCase().includes(l.toLowerCase()),t="all"===p||e.action===p,s="all"===b||e.userName===b;return a&&t&&s}),q=Array.from(new Set(a.map(e=>e.action))),z=Array.from(new Set(a.map(e=>e.userName)));return(0,s.jsxs)(x.Zb,{children:[(0,s.jsx)(x.Ol,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(x.ll,{children:"Audit jurnali"}),(0,s.jsx)(x.SZ,{children:"Tizimda amalga oshirilgan barcha o'zgarishlar tarixi"})]}),(0,s.jsxs)(o.z,{variant:"outline",size:"sm",children:[(0,s.jsx)(u.Z,{className:"h-4 w-4 mr-2"}),"Eksport"]})]})}),(0,s.jsxs)(x.aY,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,s.jsxs)("div",{className:"relative flex-1",children:[(0,s.jsx)(h.Z,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),(0,s.jsx)(c.I,{placeholder:"Qidirish...",value:l,onChange:e=>r(e.target.value),className:"pl-8"})]}),(0,s.jsxs)(m.Ph,{value:p,onValueChange:N,children:[(0,s.jsx)(m.i4,{className:"w-full sm:w-[200px]",children:(0,s.jsx)(m.ki,{placeholder:"Harakat turi"})}),(0,s.jsxs)(m.Bw,{children:[(0,s.jsx)(m.Ql,{value:"all",children:"Barcha harakatlar"}),q.map(e=>(0,s.jsx)(m.Ql,{value:e,children:e},e))]})]}),(0,s.jsxs)(m.Ph,{value:b,onValueChange:k,children:[(0,s.jsx)(m.i4,{className:"w-full sm:w-[200px]",children:(0,s.jsx)(m.ki,{placeholder:"Foydalanuvchi"})}),(0,s.jsxs)(m.Bw,{children:[(0,s.jsx)(m.Ql,{value:"all",children:"Barcha foydalanuvchilar"}),z.map(e=>(0,s.jsx)(m.Ql,{value:e,children:e},e))]})]})]}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:[w.length," ta yozuv topildi"]}),(0,s.jsx)("div",{className:"rounded-md border",children:(0,s.jsxs)(n.iA,{children:[(0,s.jsx)(n.xD,{children:(0,s.jsxs)(n.SC,{children:[(0,s.jsx)(n.ss,{children:"Sana va vaqt"}),(0,s.jsx)(n.ss,{children:"Foydalanuvchi"}),(0,s.jsx)(n.ss,{children:"Harakat"}),(0,s.jsx)(n.ss,{children:"Integratsiya"}),(0,s.jsx)(n.ss,{children:"O'zgarishlar"}),(0,s.jsx)(n.ss,{className:"w-[100px]",children:"Amallar"})]})}),(0,s.jsx)(n.RM,{children:w.map(e=>(0,s.jsxs)(n.SC,{children:[(0,s.jsx)(n.pj,{className:"font-mono text-sm",children:new Date(e.timestamp).toLocaleString("en-GB")}),(0,s.jsx)(n.pj,{children:e.userName}),(0,s.jsx)(n.pj,{children:(0,s.jsx)(d.C,{variant:"outline",className:(0,j.cn)("text-xs",y[e.action]||y.default),children:v[e.action]||e.action})}),(0,s.jsx)(n.pj,{className:"max-w-[200px] truncate",children:e.integrationName||"-"}),(0,s.jsx)(n.pj,{className:"max-w-[300px]",children:(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:e.changes&&Object.keys(e.changes).length>0?(0,s.jsx)("div",{className:"space-y-1",children:Object.keys(e.changes).map(e=>{let a=f[e]||e;return(0,s.jsx)("div",{className:"truncate",children:(0,s.jsx)("span",{className:"font-medium",children:a})},e)})}):"-"})}),(0,s.jsx)(n.pj,{children:(0,s.jsx)(o.z,{variant:"ghost",size:"sm",onClick:()=>null==t?void 0:t(e),children:(0,s.jsx)(g.Z,{className:"h-4 w-4"})})})]},e.id))})]})}),0===w.length&&(0,s.jsx)("div",{className:"text-center py-8",children:(0,s.jsx)("p",{className:"text-muted-foreground",children:"Qidiruv bo'yicha natija topilmadi"})})]})]})}var N=t(6512),b=t(92369),k=t(91723),w=t(48736);function q(e){let{versions:a,onViewVersion:t}=e,i=[...a].sort((e,a)=>a.version-e.version);return(0,s.jsxs)(x.Zb,{children:[(0,s.jsxs)(x.Ol,{children:[(0,s.jsx)(x.ll,{children:"Versiya tarixi"}),(0,s.jsx)(x.SZ,{children:"Integratsiya o'zgarishlari tarixi va versiyalari"})]}),(0,s.jsxs)(x.aY,{children:[(0,s.jsx)("div",{className:"space-y-6",children:i.map((e,a)=>(0,s.jsxs)("div",{className:"relative",children:[a<i.length-1&&(0,s.jsx)("div",{className:"absolute left-4 top-8 h-full w-px bg-border"}),(0,s.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsxs)(d.C,{variant:0===a?"default":"secondary",className:"h-8 w-8 rounded-full p-0 flex items-center justify-center",children:["v",e.version]})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"flex items-center space-x-2",children:(0,s.jsxs)("h4",{className:"font-medium",children:["Versiya ",e.version,0===a&&(0,s.jsx)(d.C,{variant:"outline",className:"ml-2 text-xs",children:"Joriy"})]})}),(0,s.jsxs)(o.z,{variant:"ghost",size:"sm",onClick:()=>null==t?void 0:t(e),children:[(0,s.jsx)(g.Z,{className:"h-4 w-4 mr-2"}),"Ko'rish"]})]}),(0,s.jsxs)("div",{className:"mt-2 space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center text-sm text-muted-foreground",children:[(0,s.jsx)(b.Z,{className:"h-3 w-3 mr-1"}),e.changedBy,(0,s.jsx)(k.Z,{className:"h-3 w-3 ml-4 mr-1"}),new Date(e.changedAt).toLocaleString("en-GB")]}),e.changeReason&&(0,s.jsxs)("div",{className:"flex items-start text-sm",children:[(0,s.jsx)(w.Z,{className:"h-3 w-3 mr-1 mt-0.5 flex-shrink-0"}),(0,s.jsx)("span",{className:"text-muted-foreground",children:e.changeReason})]}),Object.keys(e.data).length>0&&(0,s.jsxs)("div",{className:"mt-3",children:[(0,s.jsx)("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"O'zgargan maydonlar:"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-1",children:Object.keys(e.data).map(e=>(0,s.jsx)(d.C,{variant:"outline",className:"text-xs",children:e},e))})]})]})]})]}),a<i.length-1&&(0,s.jsx)(N.Z,{className:"mt-6"})]},e.id))}),0===a.length&&(0,s.jsx)("div",{className:"text-center py-8",children:(0,s.jsx)("p",{className:"text-muted-foreground",children:"Versiya tarixi mavjud emas"})})]})]})}var z=t(26110),I=t(31047),S=t(50091);let A={created:"Integratsiya yaratildi",updated:"Integratsiya tahrirlandi",deleted:"Integratsiya o'chirildi"},Z={created:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",updated:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",deleted:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300","Integratsiya yaratildi":"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300","Integratsiya tahrirlandi":"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300","Integratsiya arxivlandi":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300","Integratsiya o'chirildi":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300","Integratsiya ko'rildi":"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300","Tizim sozlamalari o'zgartirildi":"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300",default:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300"},O={axborotTizimiNomi:"Axborot tizimi yoki resursning to'liq nomi (yoki interfeys)",integratsiyaUsuli:"Integratsiyani amalga oshirish usuli",malumotNomi:"Uzatiladigan/qabul qilinadigan ma'lumot nomi",tashkilotNomiVaShakli:"Integratsiya qilingan tashkilot nomi va shakli",asosiyMaqsad:"Integratsiyadan asosiy maqsad",normativHuquqiyHujjat:"Normativ-huquqiy hujjat",texnologikYoriknomaMavjudligi:"Texnologik yo'riqnoma mavjudligi",malumotFormati:"Ma'lumot formati",maqlumotAlmashishSharti:"Ma'lumot almashish sharti",yangilanishDavriyligi:"Ma'lumot yangilanish davriyligi",malumotHajmi:"Ma'lumot hajmi",aloqaKanali:"Hamkor tashkilot bilan aloqa kanali",oxirgiUzatishVaqti:"So'nggi muvaffaqiyatli uzatish vaqti",markaziyBankAloqa:"Markaziy bank tomonidan texnik aloqa shaxsi",hamkorAloqa:"Hamkor tashkilot tomonidan texnik aloqa shaxsi",status:"Integratsiya holati / statusi",izoh:"Izoh / qo'shimcha ma'lumot"},C={0:"Yanvar",1:"Fevral",2:"Mart",3:"Aprel",4:"May",5:"Iyun",6:"Iyul",7:"Avgust",8:"Sentabr",9:"Oktabr",10:"Noyabr",11:"Dekabr"};function M(e){let{log:a,open:t,onOpenChange:i}=e;return a?(0,s.jsx)(z.Vq,{open:t,onOpenChange:i,children:(0,s.jsxs)(z.cZ,{className:"max-w-4xl",children:[(0,s.jsx)(z.fK,{children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)(z.$N,{className:"text-xl",children:"Audit yozuvi tafsilotlari"}),(0,s.jsx)(z.Be,{className:"mt-2",children:"Tizimda amalga oshirilgan o'zgarish haqida to'liq ma'lumot"})]}),(0,s.jsx)(d.C,{className:(0,j.cn)("flex-shrink-0",Z[a.action]||Z.default),children:A[a.action]||a.action})]})}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Asosiy ma'lumotlar"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(b.Z,{className:"h-5 w-5 text-muted-foreground mt-0.5 flex-shrink-0"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-medium",children:"Foydalanuvchi"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:a.userName}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["ID: ",a.userId]})]})]}),(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(I.Z,{className:"h-5 w-5 text-muted-foreground mt-0.5 flex-shrink-0"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-medium",children:"Sana va vaqt"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:function(e){let a=new Date(e),t=a.getDate(),s=C[a.getMonth()],i=a.getFullYear(),l=String(a.getHours()).padStart(2,"0"),r=String(a.getMinutes()).padStart(2,"0"),n=String(a.getSeconds()).padStart(2,"0");return"".concat(t," ").concat(s," ").concat(i,", ").concat(l,":").concat(r,":").concat(n)}(a.timestamp)})]})]})]})]}),a.integrationId&&a.integrationName&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(N.Z,{}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Integratsiya ma'lumotlari"}),(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(S.Z,{className:"h-5 w-5 text-muted-foreground mt-0.5 flex-shrink-0"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-medium",children:"Integratsiya nomi"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:a.integrationName}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["ID: ",a.integrationId]})]})]})]})]}),a.changes&&Object.keys(a.changes).length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(N.Z,{}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"O'zgarishlar"}),(0,s.jsx)("div",{className:"space-y-3",children:Object.entries(a.changes).map(e=>{let[a,t]=e,i=O[a]||a;return(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(w.Z,{className:"h-5 w-5 text-muted-foreground mt-0.5 flex-shrink-0"}),(0,s.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,s.jsx)("p",{className:"font-medium",children:i}),t&&"object"==typeof t&&("old"in t||"new"in t)?(0,s.jsxs)("div",{className:"space-y-1 text-sm",children:[void 0!==t.old&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("span",{className:"text-red-600 dark:text-red-400 font-medium",children:["Eski:"," "]}),(0,s.jsx)("span",{className:"text-muted-foreground",children:String(t.old||"(bo'sh)")})]}),void 0!==t.new&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("span",{className:"text-green-600 dark:text-green-400 font-medium",children:["Yangi:"," "]}),(0,s.jsx)("span",{className:"text-muted-foreground",children:String(t.new||"(bo'sh)")})]})]}):(0,s.jsx)("p",{className:"text-muted-foreground font-mono text-sm",children:String(t)})]})]},a)})})]})]}),(0,s.jsx)(N.Z,{}),(0,s.jsxs)("div",{className:"text-xs text-muted-foreground space-y-1",children:[(0,s.jsxs)("p",{children:["Audit ID: ",a.id]}),(0,s.jsxs)("p",{children:["Timestamp: ",a.timestamp]})]})]})]})}):null}var _=t(12339),V=t(51817),H=t(95805),D=t(42488),Y=t(65621),F=t(19522);function U(){let[e,a]=(0,i.useState)(null),[t,n]=(0,i.useState)(!1),[o,c]=(0,i.useState)([]),[m,u]=(0,i.useState)(!0);(0,i.useEffect)(()=>{(async()=>{u(!0);try{let e=await (0,r.FA)();console.log("Yuklangan audit log'lar:",e),c(e)}catch(e){console.error("Audit log'larni yuklashda xatolik:",e),F.ZP.error("Audit log'larni yuklashda xatolik yuz berdi")}finally{u(!1)}})()},[]);let h=o.length,g=new Set(o.map(e=>e.userEmail)).size,j=o.filter(e=>new Date(e.createdAt)>new Date(Date.now()-6048e5)).length,f=o.reduce((e,a)=>(e[a.action]=(e[a.action]||0)+1,e),{}),y=o.map(e=>({id:e.id,userId:e.userId||"",userName:e.userEmail,action:e.action,integrationId:e.integrationId,integrationName:e.integrationName,changes:e.changes,timestamp:e.createdAt}));return m?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)(V.Z,{className:"h-8 w-8 animate-spin"})}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Audit va Versiyalar"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Tizim o'zgarishlari tarixi va integratsiya versiyalari"})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,s.jsxs)(x.Zb,{children:[(0,s.jsxs)(x.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(x.ll,{className:"text-sm font-medium",children:"Jami yozuvlar"}),(0,s.jsx)(w.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsxs)(x.aY,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:h}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Barcha audit yozuvlari"})]})]}),(0,s.jsxs)(x.Zb,{children:[(0,s.jsxs)(x.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(x.ll,{className:"text-sm font-medium",children:"Faol foydalanuvchilar"}),(0,s.jsx)(H.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsxs)(x.aY,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:g}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Oxirgi faoliyat ko'rsatgan"})]})]}),(0,s.jsxs)(x.Zb,{children:[(0,s.jsxs)(x.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(x.ll,{className:"text-sm font-medium",children:"Haftalik faoliyat"}),(0,s.jsx)(D.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsxs)(x.aY,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:j}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Oxirgi 7 kun davomida"})]})]}),(0,s.jsxs)(x.Zb,{children:[(0,s.jsxs)(x.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(x.ll,{className:"text-sm font-medium",children:"Versiyalar"}),(0,s.jsx)(Y.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsxs)(x.aY,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:l.length}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Saqlangan versiyalar"})]})]})]}),(0,s.jsxs)(x.Zb,{children:[(0,s.jsxs)(x.Ol,{children:[(0,s.jsx)(x.ll,{children:"Harakatlar statistikasi"}),(0,s.jsx)(x.SZ,{children:"Eng ko'p bajarilgan harakatlar"})]}),(0,s.jsx)(x.aY,{children:(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(f).map(e=>{let[a,t]=e;return(0,s.jsxs)(d.C,{variant:"secondary",className:"text-sm",children:[a,": ",t]},a)})})})]}),(0,s.jsxs)(_.mQ,{defaultValue:"audit",className:"space-y-4",children:[(0,s.jsxs)(_.dr,{children:[(0,s.jsx)(_.SP,{value:"audit",children:"Audit jurnali"}),(0,s.jsx)(_.SP,{value:"versions",children:"Versiya tarixi"})]}),(0,s.jsx)(_.nU,{value:"audit",className:"space-y-4",children:m?(0,s.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,s.jsx)(V.Z,{className:"h-8 w-8 animate-spin"})}):0===y.length?(0,s.jsx)(x.Zb,{children:(0,s.jsx)(x.aY,{className:"py-12",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(w.Z,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,s.jsx)("p",{className:"text-lg font-medium mb-2",children:"Audit log'lar hali mavjud emas"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Integratsiya qo'shish, yangilash yoki o'chirish amallari audit log'ga yoziladi"})]})})}):(0,s.jsx)(p,{logs:y,onViewDetails:e=>{a(e),n(!0)}})}),(0,s.jsx)(_.nU,{value:"versions",className:"space-y-4",children:(0,s.jsx)(q,{versions:l})})]}),(0,s.jsx)(M,{log:e,open:t,onOpenChange:n})]})}},73578:function(e,a,t){"use strict";t.d(a,{RM:function(){return n},SC:function(){return d},iA:function(){return l},pj:function(){return c},ss:function(){return o},xD:function(){return r}});var s=t(57437);t(2265);var i=t(94508);function l(e){let{className:a,...t}=e;return(0,s.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,s.jsx)("table",{"data-slot":"table",className:(0,i.cn)("w-full caption-bottom text-sm",a),...t})})}function r(e){let{className:a,...t}=e;return(0,s.jsx)("thead",{"data-slot":"table-header",className:(0,i.cn)("[&_tr]:border-b",a),...t})}function n(e){let{className:a,...t}=e;return(0,s.jsx)("tbody",{"data-slot":"table-body",className:(0,i.cn)("[&_tr:last-child]:border-0",a),...t})}function d(e){let{className:a,...t}=e;return(0,s.jsx)("tr",{"data-slot":"table-row",className:(0,i.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",a),...t})}function o(e){let{className:a,...t}=e;return(0,s.jsx)("th",{"data-slot":"table-head",className:(0,i.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...t})}function c(e){let{className:a,...t}=e;return(0,s.jsx)("td",{"data-slot":"table-cell",className:(0,i.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...t})}},12339:function(e,a,t){"use strict";t.d(a,{SP:function(){return d},dr:function(){return n},mQ:function(){return r},nU:function(){return o}});var s=t(57437);t(2265);var i=t(41312),l=t(94508);function r(e){let{className:a,...t}=e;return(0,s.jsx)(i.fC,{"data-slot":"tabs",className:(0,l.cn)("flex flex-col gap-2",a),...t})}function n(e){let{className:a,...t}=e;return(0,s.jsx)(i.aV,{"data-slot":"tabs-list",className:(0,l.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",a),...t})}function d(e){let{className:a,...t}=e;return(0,s.jsx)(i.xz,{"data-slot":"tabs-trigger",className:(0,l.cn)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),...t})}function o(e){let{className:a,...t}=e;return(0,s.jsx)(i.VY,{"data-slot":"tabs-content",className:(0,l.cn)("flex-1 outline-none",a),...t})}},97626:function(e,a,t){"use strict";t.d(a,{FA:function(){return r},My:function(){return n},Sp:function(){return l}});var s=t(2141);async function i(){try{let{data:{user:e},error:a}=await s.O.auth.getUser();if(a||!e)return null;return e.email||null}catch(e){return null}}async function l(e,a,t,l){try{let r=await i();if(!r)return console.warn("Foydalanuvchi email topilmadi, audit log yozilmadi"),!1;let{data:{user:n}}=await s.O.auth.getUser(),{data:d,error:o}=await s.O.from("audit_logs").insert({user_id:(null==n?void 0:n.id)||null,user_email:r,action:e,integration_id:a||null,integration_name:t,changes:l||null}).select();if(o)return console.error("Audit log yozishda xatolik:",o),console.error("Error details:",{code:o.code,message:o.message,details:o.details,hint:o.hint}),!1;return console.log("Audit log muvaffaqiyatli yozildi:",d),!0}catch(e){return console.error("Audit log yozishda xatolik:",e),!1}}async function r(){try{let{data:e,error:a}=await s.O.from("audit_logs").select("*").order("created_at",{ascending:!1});if(a)throw console.error("Audit log'larni o'qishda Supabase xatolik:",a),a;if(!e||0===e.length)return console.log("Audit log'lar topilmadi. Jadval mavjudmi?"),[];let t=e.map(e=>({id:e.id,userId:e.user_id,userEmail:e.user_email,action:e.action,integrationId:e.integration_id,integrationName:e.integration_name,changes:e.changes?"string"==typeof e.changes?JSON.parse(e.changes):e.changes:void 0,createdAt:e.created_at}));return console.log("Topilgan ".concat(t.length," ta audit log")),t}catch(a){var e;return console.error("Audit log'larni o'qishda xatolik:",a),((null==a?void 0:a.code)==="42P01"||(null==a?void 0:null===(e=a.message)||void 0===e?void 0:e.includes("does not exist")))&&console.error("'audit_logs' jadvali mavjud emas. Migration'ni ishga tushiring!"),[]}}function n(e,a){let t={};return["axborotTizimiNomi","integratsiyaUsuli","malumotNomi","tashkilotNomiVaShakli","asosiyMaqsad","normativHuquqiyHujjat","texnologikYoriknomaMavjudligi","malumotFormati","maqlumotAlmashishSharti","yangilanishDavriyligi","malumotHajmi","aloqaKanali","oxirgiUzatishVaqti","markaziyBankAloqa","hamkorAloqa","status","izoh"].forEach(s=>{let i=null==e?void 0:e[s],l=a[s];i!==l&&(t[s]={old:i,new:l})}),t}}},function(e){e.O(0,[886,604,983,954,439,971,117,744],function(){return e(e.s=48979)}),_N_E=e.O()}]);