(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{68360:function(e,r,t){Promise.resolve().then(t.bind(t,66374))},66374:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return h}});var a=t(57437),i=t(2265),n=t(99376),s=t(16023),o=t(62869),l=t(95186),u=t(26815),d=t(66070),c=t(51817),m=t(19522);function h(){let[e,r]=(0,i.useState)(""),[t,h]=(0,i.useState)(""),[f,g]=(0,i.useState)(!1),{login:v}=(0,s.a)(),p=(0,n.useRouter)(),y=async r=>{if(r.preventDefault(),!e||!t){m.ZP.error("Email va parolni kiriting");return}g(!0);try{let{error:r}=await v(e,t);r?m.ZP.error(r):(m.ZP.success("Muvaffaqiyatli kirildi!"),p.push("/integrations"))}catch(e){m.ZP.error(e.message||"Kirishda xatolik yuz berdi")}finally{g(!1)}};return(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-black",children:(0,a.jsxs)(d.Zb,{className:"w-full max-w-md",children:[(0,a.jsxs)(d.Ol,{className:"space-y-1",children:[(0,a.jsx)(d.ll,{className:"text-2xl font-bold text-center",children:"Tizimga kirish"}),(0,a.jsx)(d.SZ,{className:"text-center",children:"Email va parolingizni kiriting"})]}),(0,a.jsx)(d.aY,{children:(0,a.jsxs)("form",{onSubmit:y,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(u._,{htmlFor:"email",children:"Email"}),(0,a.jsx)(l.I,{id:"email",type:"email",placeholder:"name@example.com",value:e,onChange:e=>r(e.target.value),disabled:f,required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(u._,{htmlFor:"password",children:"Parol"}),(0,a.jsx)(l.I,{id:"password",type:"password",placeholder:"Parolingizni kiriting",value:t,onChange:e=>h(e.target.value),disabled:f,required:!0})]}),(0,a.jsx)(o.z,{type:"submit",className:"w-full",disabled:f,children:f?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Kirilmoqda..."]}):"Kirish"})]})})]})})}},62869:function(e,r,t){"use strict";t.d(r,{d:function(){return o},z:function(){return l}});var a=t(57437);t(2265);var i=t(37053),n=t(90535),s=t(94508);let o=(0,n.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function l(e){let{className:r,variant:t,size:n,asChild:l=!1,...u}=e,d=l?i.g7:"button";return(0,a.jsx)(d,{"data-slot":"button",className:(0,s.cn)(o({variant:t,size:n,className:r})),...u})}},66070:function(e,r,t){"use strict";t.d(r,{Ol:function(){return s},SZ:function(){return l},Zb:function(){return n},aY:function(){return u},ll:function(){return o}});var a=t(57437);t(2265);var i=t(94508);function n(e){let{className:r,...t}=e;return(0,a.jsx)("div",{"data-slot":"card",className:(0,i.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",r),...t})}function s(e){let{className:r,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,i.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",r),...t})}function o(e){let{className:r,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,i.cn)("leading-none font-semibold",r),...t})}function l(e){let{className:r,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-description",className:(0,i.cn)("text-muted-foreground text-sm",r),...t})}function u(e){let{className:r,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,i.cn)("px-6",r),...t})}},95186:function(e,r,t){"use strict";t.d(r,{I:function(){return n}});var a=t(57437);t(2265);var i=t(94508);function n(e){let{className:r,type:t,...n}=e;return(0,a.jsx)("input",{type:t,"data-slot":"input",className:(0,i.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",r),...n})}},26815:function(e,r,t){"use strict";t.d(r,{_:function(){return s}});var a=t(57437);t(2265);var i=t(6394),n=t(94508);function s(e){let{className:r,...t}=e;return(0,a.jsx)(i.f,{"data-slot":"label",className:(0,n.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",r),...t})}},16023:function(e,r,t){"use strict";t.d(r,{a:function(){return o}});var a=t(2141),i=t(94967),n=t(73708),s=t(6943);let o=(0,n.U)()((0,s.tJ)(e=>({user:null,loading:!0,setUser:r=>e({user:r}),setLoading:r=>e({loading:r}),login:async(r,t)=>{try{let{data:n,error:s}=await a.O.auth.signInWithPassword({email:r,password:t});if(s)return{error:s.message};if(n.user)try{let t=await i.a.getUserByEmail(n.user.email||r);if(!t)return await a.O.auth.signOut(),{error:"Foydalanuvchi topilmadi yoki o'chirilgan"};return e({user:{id:n.user.id,email:n.user.email||r,role:t.role}}),{error:null}}catch(e){return await a.O.auth.signOut(),{error:"Foydalanuvchi ma'lumotlarini olishda xatolik"}}return{error:"Login failed"}}catch(e){return{error:e.message||"Login failed"}}},logout:async()=>{try{await a.O.auth.signOut(),e({user:null})}catch(e){console.error("Logout error:",e)}},checkAuth:async()=>{try{var r,t;let n=null===(t=JSON.parse(localStorage.getItem("auth-storage")||"{}"))||void 0===t?void 0:null===(r=t.state)||void 0===r?void 0:r.user;e({loading:!0});let{data:{user:s},error:o}=await a.O.auth.getUser();if(o||!s){e({user:null,loading:!1});return}if(n&&n.email===s.email&&n.role){e({user:{id:s.id,email:s.email||"",role:n.role},loading:!1});return}try{let r=await i.a.getUserByEmail(s.email||"");if(!r){console.log("Foydalanuvchi ".concat(s.email," users jadvalida topilmadi, logout qilinmoqda")),await a.O.auth.signOut(),e({user:null,loading:!1});return}e({user:{id:s.id,email:s.email||"",role:r.role},loading:!1})}catch(r){console.error("Auth check error:",r),await a.O.auth.signOut(),e({user:null,loading:!1})}}catch(r){console.error("Auth check error:",r),e({user:null,loading:!1})}}}),{name:"auth-storage",storage:(0,s.FL)(()=>localStorage),partialize:e=>({user:e.user})}))},2141:function(e,r,t){"use strict";t.d(r,{O:function(){return s}});var a=t(71545);let i="https://ssysxmsqtxsqshznupmw.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNzeXN4bXNxdHhzcXNoem51cG13Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIxNDI1MDUsImV4cCI6MjA3NzcxODUwNX0.DW8LU5htQmahNXLYN0Y5fdyyAjCK7UfLXPs03n0O-ME";i&&n||console.warn("Supabase URL yoki Anon Key topilmadi. Iltimos, .env.local faylida NEXT_PUBLIC_SUPABASE_URL va NEXT_PUBLIC_SUPABASE_ANON_KEY qo'shing.");let s=(0,a.eI)(i,n,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}})},94967:function(e,r,t){"use strict";t.d(r,{a:function(){return n}});var a=t(2141);function i(e){return{id:e.id,name:e.name,email:e.email,role:e.role}}let n={getUsers:async()=>{try{let{data:e,error:r}=await a.O.from("users").select("*").order("created_at",{ascending:!1});if(r)throw r;return(e||[]).map(i)}catch(e){throw console.error("Foydalanuvchilarni olishda xatolik:",e),e}},getUser:async e=>{try{let{data:r,error:t}=await a.O.from("users").select("*").eq("id",e).single();if(t)throw t;return r?i(r):null}catch(e){throw console.error("Foydalanuvchini olishda xatolik:",e),e}},getUserByEmail:async e=>{try{let{data:r,error:t}=await a.O.from("users").select("*").eq("email",e).maybeSingle();if(t){if("PGRST116"===t.code)return null;throw t}return r?i(r):null}catch(t){var r;if((null==t?void 0:t.code)==="PGRST116"||(null==t?void 0:null===(r=t.message)||void 0===r?void 0:r.includes("0 rows")))return console.log("Foydalanuvchi ".concat(e," users jadvalida topilmadi")),null;return console.error("Foydalanuvchini email orqali olishda xatolik:",t),null}},addUser:async e=>{try{var r,t,n,s,o,l,u;let{data:d,error:c}=await (null===(r=a.O.auth.admin)||void 0===r?void 0:r.createUser({email:e.email,password:e.password,email_confirm:!0}));if(c){if((null===(t=c.message)||void 0===t?void 0:t.includes("already registered"))||(null===(n=c.message)||void 0===n?void 0:n.includes("already exists"))||(null===(s=c.message)||void 0===s?void 0:s.includes("User already registered")))throw Error("Bu email bilan foydalanuvchi allaqachon mavjud");let{data:r,error:d}=await a.O.auth.signUp({email:e.email,password:e.password});if(d){if((null===(o=d.message)||void 0===o?void 0:o.includes("already registered"))||(null===(l=d.message)||void 0===l?void 0:l.includes("already exists"))||(null===(u=d.message)||void 0===u?void 0:u.includes("User already registered")))throw Error("Bu email bilan foydalanuvchi allaqachon mavjud");throw d}if(!r.user)throw Error("Foydalanuvchi yaratilmadi");let{data:m,error:h}=await a.O.from("users").insert({id:r.user.id,name:e.name,email:e.email,role:e.role,is_active:!0}).select().single();if(h)throw h;return i(m)}if(!d.user)throw Error("Foydalanuvchi yaratilmadi");let{data:m,error:h}=await a.O.from("users").insert({id:d.user.id,name:e.name,email:e.email,role:e.role,is_active:!0}).select().single();if(h)throw h;return i(m)}catch(e){throw console.error("Foydalanuvchi qo'shishda xatolik:",e),e}},updateUser:async(e,r)=>{try{let t={};void 0!==r.name&&(t.name=r.name),void 0!==r.email&&(t.email=r.email),void 0!==r.role&&(t.role=r.role),t.updated_at=new Date().toISOString();let{data:n,error:s}=await a.O.from("users").update(t).eq("id",e).select().single();if(s)throw s;return n?i(n):null}catch(e){throw console.error("Foydalanuvchini yangilashda xatolik:",e),e}},updateUserPassword:async(e,r)=>{try{var t;let{error:i}=await (null===(t=a.O.auth.admin)||void 0===t?void 0:t.updateUserById(e,{password:r}));if(i)return console.warn("Admin API mavjud emas. Parol yangilash uchun Edge Function ishlatilishi kerak."),!1;return!0}catch(e){return console.error("Parolni yangilashda xatolik:",e),!1}},deleteUser:async e=>{try{try{var r;let{error:t}=await (null===(r=a.O.auth.admin)||void 0===r?void 0:r.deleteUser(e));t&&console.warn("Auth'dan o'chirishda xatolik:",t)}catch(e){console.warn("Auth admin API mavjud emas yoki xatolik:",e)}let{error:t}=await a.O.from("users").delete().eq("id",e);if(t)throw t;return!0}catch(e){throw console.error("Foydalanuvchini o'chirishda xatolik:",e),e}}}},94508:function(e,r,t){"use strict";t.d(r,{cn:function(){return n},p:function(){return s}});var a=t(61994),i=t(53335);function n(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,i.m6)((0,a.W)(r))}function s(e){return new Date(e).toLocaleDateString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit"})}},99376:function(e,r,t){"use strict";var a=t(35475);t.o(a,"useParams")&&t.d(r,{useParams:function(){return a.useParams}}),t.o(a,"usePathname")&&t.d(r,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(r,{useSearchParams:function(){return a.useSearchParams}})},6394:function(e,r,t){"use strict";t.d(r,{f:function(){return o}});var a=t(2265),i=t(66840),n=t(57437),s=a.forwardRef((e,r)=>(0,n.jsx)(i.WV.label,{...e,ref:r,onMouseDown:r=>{var t;r.target.closest("button, input, select, textarea")||(null===(t=e.onMouseDown)||void 0===t||t.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));s.displayName="Label";var o=s},6943:function(e,r,t){"use strict";function a(e,r){let t;try{t=e()}catch(e){return}return{getItem:e=>{var a;let i=e=>null===e?null:JSON.parse(e,null==r?void 0:r.reviver),n=null!=(a=t.getItem(e))?a:null;return n instanceof Promise?n.then(i):i(n)},setItem:(e,a)=>t.setItem(e,JSON.stringify(a,null==r?void 0:r.replacer)),removeItem:e=>t.removeItem(e)}}t.d(r,{FL:function(){return a},tJ:function(){return n}});let i=e=>r=>{try{let t=e(r);if(t instanceof Promise)return t;return{then:e=>i(e)(t),catch(e){return this}}}catch(e){return{then(e){return this},catch:r=>i(r)(e)}}},n=(e,r)=>(t,n,s)=>{let o,l={storage:a(()=>localStorage),partialize:e=>e,version:0,merge:(e,r)=>({...r,...e}),...r},u=!1,d=new Set,c=new Set,m=l.storage;if(!m)return e((...e)=>{console.warn(`[zustand persist middleware] Unable to update item '${l.name}', the given storage is currently unavailable.`),t(...e)},n,s);let h=()=>{let e=l.partialize({...n()});return m.setItem(l.name,{state:e,version:l.version})},f=s.setState;s.setState=(e,r)=>(f(e,r),h());let g=e((...e)=>(t(...e),h()),n,s);s.getInitialState=()=>g;let v=()=>{var e,r;if(!m)return;u=!1,d.forEach(e=>{var r;return e(null!=(r=n())?r:g)});let a=(null==(r=l.onRehydrateStorage)?void 0:r.call(l,null!=(e=n())?e:g))||void 0;return i(m.getItem.bind(m))(l.name).then(e=>{if(e){if("number"!=typeof e.version||e.version===l.version)return[!1,e.state];if(l.migrate){let r=l.migrate(e.state,e.version);return r instanceof Promise?r.then(e=>[!0,e]):[!0,r]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]}).then(e=>{var r;let[a,i]=e;if(t(o=l.merge(i,null!=(r=n())?r:g),!0),a)return h()}).then(()=>{null==a||a(o,void 0),o=n(),u=!0,c.forEach(e=>e(o))}).catch(e=>{null==a||a(void 0,e)})};return s.persist={setOptions:e=>{l={...l,...e},e.storage&&(m=e.storage)},clearStorage:()=>{null==m||m.removeItem(l.name)},getOptions:()=>l,rehydrate:()=>v(),hasHydrated:()=>u,onHydrate:e=>(d.add(e),()=>{d.delete(e)}),onFinishHydration:e=>(c.add(e),()=>{c.delete(e)})},l.skipHydration||v(),o||g}},73708:function(e,r,t){"use strict";t.d(r,{U:function(){return l}});var a=t(2265);let i=e=>{let r;let t=new Set,a=(e,a)=>{let i="function"==typeof e?e(r):e;if(!Object.is(i,r)){let e=r;r=(null!=a?a:"object"!=typeof i||null===i)?i:Object.assign({},r,i),t.forEach(t=>t(r,e))}},i=()=>r,n={setState:a,getState:i,getInitialState:()=>s,subscribe:e=>(t.add(e),()=>t.delete(e))},s=r=e(a,i,n);return n},n=e=>e?i(e):i,s=e=>e,o=e=>{let r=n(e),t=e=>(function(e,r=s){let t=a.useSyncExternalStore(e.subscribe,a.useCallback(()=>r(e.getState()),[e,r]),a.useCallback(()=>r(e.getInitialState()),[e,r]));return a.useDebugValue(t),t})(r,e);return Object.assign(t,r),t},l=e=>e?o(e):o}},function(e){e.O(0,[886,604,971,117,744],function(){return e(e.s=68360)}),_N_E=e.O()}]);